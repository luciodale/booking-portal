---
interface Props {
    name: string;
    label?: string;
    options: Array<{ value: string; text: string; disabled?: boolean }>;
    placeholder?: string;
    value?: string;
    required?: boolean;
    disabled?: boolean;
    class?: string;
}

const {
    name,
    label,
    options,
    placeholder,
    value,
    required = false,
    disabled = false,
    class: className,
} = Astro.props;
---

<div class:list={["form-field", className]}>
    {
        label && (
            <label
                for={name}
                class="block text-sm text-muted-foreground mb-2.5 font-medium"
            >
                {label}
                {required && <span class="text-error ml-1">*</span>}
            </label>
        )
    }
    <div class="relative">
        <select
            id={name}
            name={name}
            required={required}
            disabled={disabled}
            class:list={[
                "w-full px-4 py-3.5 pr-12 rounded-xl text-foreground",
                "bg-secondary border border-border/50",
                "transition-all duration-200",
                "focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary",
                "hover:bg-card-hover",
                "disabled:opacity-50 disabled:cursor-not-allowed",
                "appearance-none cursor-pointer",
            ]}
        >
            {
                placeholder && (
                    <option value="" disabled selected={!value}>
                        {placeholder}
                    </option>
                )
            }
            {
                options.map((option) => (
                    <option
                        value={option.value}
                        disabled={option.disabled}
                        selected={option.value === value}
                    >
                        {option.text}
                    </option>
                ))
            }
        </select>

        <!-- Custom Dropdown Arrow -->
        <div
            class="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground"
        >
            <svg
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19 9l-7 7-7-7"></path>
            </svg>
        </div>
    </div>
</div>

<style>
    .form-field select:focus {
        box-shadow: 0 0 0 3px var(--color-primary-hover, oklch(0.8 0.14 85)) /
            0.15;
    }

    .form-field select option {
        background: var(--color-card);
        color: var(--color-foreground);
        padding: 0.5rem;
    }
</style>
